\section{Chain Complexes}\label{sec-chain-complexes}
\begin{definition}
A \defn{chain complex} is a family $(A_i)_{i\in\mathbb{Z}}$ of abelian groups, as well as a family $(f_i:A_i\rightarrow A_{i+1})_{i\in \mathbb{Z}}$ of homomorphisms between consecutive groups, such that $im(f_i)\subset ker(f_{i+1})$. If we have equality instead of inclusion, the family is called an \defn{exact sequence}.
\end{definition}

We distinguish between \defn{short} and \defn{long exact sequences}, where short exact sequences are sequences with three or fewer consecutive non-zero groups, i.e. sequences of the form

% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRGJAF9T1Nd9CKAIzkqtRizYBBLjxAZseAkQBMo6vWatEIAEKzeigUQDM68VrYBhA-L5LByACznNknR05iYUAObwiUAAzACcIAFskMhAcCCQRC3d2W1CI+OpYpDVE7RAglLDIxGzMxDMctl8CtLKMuMQXCo8uCk4gA
\[\begin{tikzcd}
0 \arrow[r, "0"] & A \arrow[r, "f"] & B \arrow[r, "g"] & C \arrow[r, "0"] & 0
\end{tikzcd}\]
All other exact sequences are called long exact sequences. 

\begin{example}
For any abelian group $A$ the following is a long exact sequence:
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZARgBoAGAXVJADcBDAGwFcYkQBBEAX1PU1z5CKAEwVqdJq3Zde-bHgJEAzOJoMWbRJx58QGBUKIAWNZM3sAOpagQcCOfoGLhycmY3Tt12-Z4SYKABzeCJQADMAJwgAWyR3EBwIJDJzLxAsKF0I6LjEVKSkMTStEHJskCjYoppCxFUS9kyKqrzTROTEBM9S8u5KbiA
\[\begin{tikzcd}
\dots \arrow[r, "0"] & A \arrow[r, "id"] & A \arrow[r, "0"] & A \arrow[r, "id"] & \dots
\end{tikzcd}\]
\end{example}

\begin{remark}
The requirement that $im(f_i)\subseteq ker(f_{i+1})$  is equivalent to the requirement that $f_{i+1}\circ f_i=0$. This is clear from the definition: if $im(f_i)\subseteq ker(f_{i+1})$ then $$\forall x\in A_i, f_{i+1}\circ f_i (x)\in f_{i+1}(im(f_i))=\{0\}.$$ Additionally, if $\forall x\in A_i, f_{i+1}\circ f_i=0$ then $f_{i+1}(im(f_i))=\{0\}$.
\end{remark}


\begin{example}
Suppose the following is part of a long exact sequence of groups.
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZARgBoAGAXVJADcBDAGwFcYkQBBEAX1PU1z5CKAEwVqdJq3YAhHnxAZseAkQDM4mgxZtEIAMLz+yoUQAsmyTvYARI4oErhyAKyXt0vQB0vUCDgReY0FVFHJ3KV0QHz8AngkYKABzeCJQADMAJwgAWyRwkBwIJDIrTxByeyzckpoipDEyqPSq7LzERvrEDSb2SqCQavaerrMBoaQ3QuLEcm5KbiA
\[\begin{tikzcd}
\dots \arrow[r] & A \arrow[r, "0"] & B \arrow[r, "f"] & C \arrow[r, "0"] & D \arrow[r] & \dots
\end{tikzcd}\]
We say this \defn{gives rise to} the following short exact sequence, as they carry the same information.
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRGJAF9T1Nd9CKAIzkqtRizYAhLjxAZseAkQBMo6vWatEIAMKzeigUQDM68VrYdOYmFADm8IqABmAJwgBbJCJA4ISGoWkjouBiDuXkhkfgGIQtyuHt6IQf5IJjacQA
\[\begin{tikzcd}
0 \arrow[r] & B \arrow[r, "f"] & C \arrow[r] & 0
\end{tikzcd}\]
Note we can omit specifying any homomorphisms from or into $0$, as there is only one: the $0$-homomorphism. Since $0=im(0)=ker(f)$, $f$ is injective. Since $im(f)=ker(0)=C$, $f$ is surjective. Therefore $f$ is an isomorphism.
\end{example}

\begin{definition}
If there exist maps $f:A\rightarrow B$ and $g:B\rightarrow A$ between abelian groups such that $g\circ f = id_A$ then $g$ is called a \defn{retraction} of $f$. If alternatively $f\circ g=id_B$, then $f$ is called a \defn{section} of $f$.
\end{definition}
This definition formalises the idea of a "one-sided inverse".

\begin{prop}\label{short-seq-direct-sum}
Let the following be a short exact sequence
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRGJAF9T1Nd9CKACzkqtRizYduvbHgJEAjKOr1mrRCACCXHiAxyBRAEwrx6tgCFds-gpQBmM2smaAwlzEwoAc3hFQADMAJwgAWyQyEBwIJGMZEBDwpBFo2MRFBKSIxFM0pCdzV0SbRNCcwpiU1QkNEB9PTiA
\[\begin{tikzcd}
0 \arrow[r] & A \arrow[r, "f"] & B \arrow[r, "g"] & C \arrow[r] & 0
\end{tikzcd}\]
\begin{enumerate}[(a)]
    \item If there exists a \defn{section} $s:C\rightarrow B$ of $g$, then $f$ and $s$ define an isomorphism $$(f+s):A\dsum C\rightarrow B$$
$$(a,c)\mapsto f(a)+s(c).$$
\item If there exists a \defn{retraction} $r:B\rightarrow A$ of $f$, then $r$ and $g$ define an isomorphism $$(r,g):B\rightarrow A\dsum C$$
$$b\mapsto (r(b),g(b)).$$
\end{enumerate}
\end{prop}

\begin{proof}
\begin{enumerate}[(a)]
\item First we show that $(f+s)$ is injective. By exactness we have that $f$ is injective, as $0=im(0)=ker(f)$, and that $g$ is surjective, as $im(g)=ker(0)=C$. Suppose $f(a)+s(c)=0$. Then $$0=g(0)=g(f(a)+s(c))=gf(a)+gs(c)=c$$
Which implies $c=0$. But then $0=f(a)$, which implies $a=0$ as $f$ is injective. Therefore $ker(f+s)=0$, so $(f+s)$ is injective.

Next we show $(f+s)$ is surjective. Let $b\in B$, $c=g(b)\in C$ and $a\in A$ be the unique element that maps to $b-sg(b)\in B$. This element exists, since $$g(b-s(g(b)))=g(b)-g(b)=0,$$ so $b-sg(b)\in ker(g)=im(f)$. It is unique by the injectivity of $f$. It follows that $$f(a)+s(c)=b-sg(b)+sg(b)=b,$$ so $(f,s)$ is surjective. It is therefore an isomorphism.

\item First we show that $(r,g)$ is injective. Suppose $(r(b),g(b))=(0,0)$. Then $g(b)=0,$ so $b\in ker(g)=im(f)$. Now $r$ is injective on $im(f)$, since $rf=id_A$. Therefore $r(b)=0\implies b=0$. So $(r,g)$ is injective.

Next we show $(r,g)$ is surjective. Let $(a,c)\in A\dsum C$. Since $g$ is surjective, there exists $b\in B$ such that $c=g(b)$. Let $x=f(a)+b-fr(b)\in B$. Then $g(x)=g(b)$, as $gf(-)=0$ by exactness. Additionally, $$r(x)=rf(a)+r(b)-rfr(b)=a+r(b)-r(b)=a,$$
since $rf=id_A$. It follows that $(r,g)$ is also surjective, so it is an isomorphism.
\end{enumerate}

\end{proof}
%TRASH PROPOSITION
\begin{corollary}\label{retraction-iso}
If $f:A\rightarrow B$ admits a retraction $g:B\rightarrow A$, then $$B\iso im(f)\dsum ker(g)$$
\end{corollary}

\begin{proof}
We can define $r|:=r|_{im(f)}:im(f)\rightarrow A$, which is injective since $rf$ is an isomorphism. Trivially we can define $f:A\rightarrow im(f)$, which by abuse of notation we give the same name as $f:A\rightarrow B$. The composition $fr|(x):im(f)\rightarrow B$ is injective, as $$fr|(x)=0\implies r|(x)=r(0)=0\implies x=0$$
as $r|$ is injective.

We can also define a homomorphism $$h:B\rightarrow ker(r)$$
$$x\mapsto x-fr(x)$$
since $r(x-fr(x))=r(x)-r(x)=0$. Note $h$ is surjective, as if $r(x)=0$, then $fr(x)=0$, so $x=x-fr(x)=h(x)$, where by abuse of notation, we are considering $x$ to be both in $ker(r)$ and $B$.

Note $h(fr|)(x)=fr|(x)-fr(fr|(x))=fr|(x)-fr|(x)=0$, as $rf=id_B$. So $im(f)\subseteq ker(h)$. Additionally, if $x-fr|(x)=0$, then $x=fr|(x)$, so $ker(h)\subseteq im(f)$. The horizontal part of the following commutative diagram is therefore a short exact sequence:

% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZAJgBoAGAXVJADcBDAGwFcYkQAhEAX1PU1z5CKAIwVqdJq3ZYAtgAoAZgEoefEBmx4CRMSIkMWbRCACCa-lqFFy4moeknyFjQO3DkAZjuSj7ANYwAE7yQaq8loI6KAAsPg7GIM7cEjBQAObwRKCKQRCySGQgOBBIYr6OIIogNABGMGBQSDEAnBFVeQWI5SWFdQ1NiLYViUEAPi65+X3FpUP2UonV-Y1Iw4z09YwACm7WJkFY6QAWOJOdazS9iEUJ7EE1IPWriK3tU13D13Ej7Mfn026VzmwzuJlyE3eF0Q3lmZShgJ+1wArCluEA
\[\begin{tikzcd}
0 \arrow[r] & im(f) \arrow[d, "r|"] \arrow[r, "fr|"]          & B \arrow[ld, "r", bend left=49] \arrow[r, "h"] & ker(r) \arrow[r] & 0 \\
            & A \arrow[u, "f", bend left=49] \arrow[ru, "f"'] &                                                &                  &  
\end{tikzcd}\]
Since $fr$ is a retraction of $fr|$, Proposition \ref{short-seq-direct-sum} gives an isomorphism $(fr,h):B\rightarrow im(f)\dsum ker(g)$
\end{proof}

We finish this section with a technical lemma that will become useful in section \ref{sec-axioms}.

\begin{lemma}[Braid lemma]\label{braid-lemma}
Suppose three long exact sequences and a chain complex make the following commutative diagram.

% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZARgBpiBdUkANwEMAbAVxiRAEEQBfU9TXfIRRkAzFVqMWbAELdeIDNjwEiAVnLj6zVohABxOXyWC1pMdS1TdACUML+yocgBMpZ5sk6QAYTuKBKigiGhaebAAifg4mQWYe2mwAolHGgcgALG7xViAAYikBTgBsWaEJugCSBY5EAAyktdle1THI9e5lOQDyLWn16U1svcUNg7rDRCUDnc1c4jBQAObwRKAAZgBOEAC2SPUgOBBImRLlIGsA+sR2mzvH1IdIJac5l843W7uIz4+IwSAAIxgYCgSAAtOkAJwzNiXEQfO6IMgHI6IE6WLwACyuCK+J1+6heWIu7x460+SEJv1cgOBoLR0KJbGx8LJ5wpiH2BOoQJBx0ZGLYixxbNuX2Rv2evPpEIFYV0ACsRfIxU8HqiAOwwxUk3FILUopA0wU61kqjlUzXakDC0nmxEG37-E02i5m8mI-6-AAc1su6T1iBpPut2IDoo5jN++2lSBEtQjiOIXNR+xdwtqgeT6qQyJdSszifFEtRyNjiDB8aLRpzSJp5fj1qV4ftXy9pf+5craflrvDFC4QA
\begin{tikzcd}
{} \arrow[rd, bend left]              &                                                      &                                       &                                                      &                                       &                                                   & {} \\
                                      & A \arrow[rd, "f_1"] \arrow[rr, "g_1", bend left=49]  &                                       & D \arrow[rr, "h_3", bend left=49] \arrow[rd, "g_2"]  &                                       & G \arrow[rd, "h_4"] \arrow[ru, "j_4", bend left]  &    \\
O \arrow[ru, "g_0"] \arrow[rd, "j_0"] &                                                      & C \arrow[rd, "f_2"] \arrow[ru, "h_2"] &                                                      & F \arrow[ru, "j_3"] \arrow[rd, "g_3"] &                                                   & I  \\
                                      & B \arrow[ru, "h_1"] \arrow[rr, "j_1", bend right=49] &                                       & E \arrow[rr, "f_3", bend right=49] \arrow[ru, "j_2"] &                                       & H \arrow[ru, "f_4"] \arrow[rd, "g_4", bend right] &    \\
{} \arrow[ru, bend right]             &                                                      &                                       &                                                      &                                       &                                                   & {}
\end{tikzcd}

Then the chain complex is also a long exact sequence.
\end{lemma}
\begin{proof}
By symmetry of the diagram, it does not matter which sequence is the chain complex. We can assume it is the sequence with homomorphisms $f_i$. We are given that $im(f_i)\subseteq ker(f_{i+1})$, and need to show that $ker(f_{i+1})\subseteq im(f_i)$. By the symmetry of the diagram, it is enough to show this for $i=1,2,3$. We will show that $ker(f_2)\subseteq im(f_1)$ here, and do the other two cases in the Appendix.

Let $x\in ker(f_2)$. Then $0=f_2(x)=j_2f_2(x)=g_2h_2(x)$ by commutativity. It follows that $h_2(x)\in ker(g_2)=im(g_1)$. So $\exists x_1\in A$ s.t. $g_1 (x_1)=h_2(x)$. By commutativity, $g_1(x_1)=h_2f_1 (x_1)$. So we have that $0=g_1 (x_1)-h_2(x)=h_2(f_1 (x_1)-x)$. Let $x_2:=f_1(x_1)-x\in ker(h_2)=im(h_1)$. Then $\exists x_3\in B$ s.t. $h_1(x_3)=x_2$.

Now note that $$j_1(x_3)=f_2h_1(x_3)=f_2(x_2)=f_2(f_1(x_1)-x)=0,$$
where the last equality follows from $f_2f_1(-)=0$ and $f_2(x)=0$. We therefore have that $x_3\in ker(j_1)=im(j_0)$. So there exists $x_4\in O$ s.t. $j_0(x_4)=x_3$. Consider $g_0(x_4).$ It satisfies $f_1g_0(x_4)=h_1j_0(x_4)=h_1(x_3)=x_2=f_1(x_1)-x$. Therefore we have
$$x=f_1(x_1-g_0(x_4)).$$
This shows $x\in im(f_1)$ as required.
\cite{Eilenberg}
\end{proof}